##############################################################
#
#                   DO NOT EDIT THIS FILE!
#
##############################################################

# If the tool is built out of the kit, PIN_ROOT must be specified in the make invo#cation and point to the kit root.

PIN_ROOT := $(shell cd ../PIN && pwd)
CONFIG_ROOT := $(PIN_ROOT)/source/tools/Config
include $(CONFIG_ROOT)/makefile.config
include makefile.rules
include $(CONFIG_ROOT)/makefile.default.rules

CC := gcc
CXX := g++
CFLAGS := -g -pthread
CXXFLAGS := -g -pthread

.SECONDARY: 

.PRECIOUS: %.dump %.symtab %_global.offset

# tartest:
# 	echo $(ARGS)

memtracker.cpp: memtracker.h
	@touch memtracker.cpp
%.out: %.cpp
	$(CXX) $(CXXFLAGS) $< -o $@
# %.dd: %.out
# 	dwarfdump $< > $@
# %.dump: %.out %.dd ./obj-intel64/memtracker.so
# 	../PIN/pin -t obj-intel64/memtracker.so -- ./$< > op.txt
%.symtab: %.out
	readelf -sW $< | grep "OBJECT" > $@
%_static.offset: %.symtab final_global.offset merge
	awk -f merge $< FS="\t" final_global.offset > $@
%.dump: %.out ./obj-intel64/memtracker.so final.offset %_static.offset
	../PIN/pin -t obj-intel64/memtracker.so -- ./$< $(inp) > op.txt
cleaner:
	-rm *.dump *.dd
	make clean

##############################################################
#
#                   DO NOT EDIT THIS FILE!
#
##############################################################
